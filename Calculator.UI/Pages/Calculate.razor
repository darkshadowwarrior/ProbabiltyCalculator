@page "/calculate"
@using Calculator.UI.Data;
@using Calculator.UI.Services;

@inject ProbabilityCalculationController ProbabilityCalculationController

<PageTitle>Calculate</PageTitle>

<h1>Calculate</h1>

<EditForm Model=@Request OnValidSubmit=@ValidFormSubmitted>
    <div class="form-group">
        <label for="Name">Probability A</label>
        <InputText @bind-Value=Request.ProbabilityA class="form-control" id="ProbabilityA" />
    </div>
    <div class="form-group">
        <label for="Name">Probability B</label>
        <InputText @bind-Value=Request.ProbabilityB class="form-control" id="ProbabilityB" />
    </div>
    <select class="form-control selectpicker" @bind="Request.TypeOfCalculation">
        <option>--select--</option>
        @foreach (var item in calculations)
        {
            <option value="@item">@item</option>
            // Blazor needs to know what values it binds to!
        }
    </select>
    <input type="submit" class="btn btn-primary" value="Save" />
</EditForm>

<p role="status">Current count: @Response.Result</p>

@code {
    string[] calculations = new string[] { "CombinedWith", "Either" };

    ProbabilityCalculationRequest Request = new ProbabilityCalculationRequest();
    ProbabilityCalculationResponse Response = new ProbabilityCalculationResponse() { Result = -1 };

    void ValidFormSubmitted(EditContext editContext)
    {
        Response = ProbabilityCalculationController.CalculateProbability(Request);
        Request = new ProbabilityCalculationRequest();
    }
}
